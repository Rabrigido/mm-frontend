<div class="relative w-full h-[700px] border rounded-xl bg-slate-50 overflow-hidden">
  <!-- Graph Canvas -->
  <div #graphContainer class="w-full h-full absolute inset-0"></div>

  <!-- Overlay Controls/Info -->
  <div class="absolute top-4 left-4 bg-white/90 p-3 rounded-lg shadow backdrop-blur-sm text-sm">
    <h3 class="font-bold mb-1">Navegación Jerárquica</h3>
    <ul class="space-y-1 text-gray-600">
      <li class="flex items-center gap-2">
        <span class="w-3 h-3 rounded-full bg-indigo-500"></span> Módulos (Carpetas)
      </li>
      <li class="flex items-center gap-2">
        <span class="w-3 h-3 rounded-full bg-slate-500"></span> Archivos
      </li>
      <li class="flex items-center gap-2">
        <span class="w-3 h-3 rounded-full bg-pink-500"></span> Clases
      </li>
      <li class="flex items-center gap-2">
        <span class="w-3 h-3 rounded-full bg-emerald-500"></span> Funciones
      </li>
    </ul>
    <p class="mt-3 text-xs text-gray-500">
      • Click en un nodo para <strong>expandir</strong> su contenido.<br>
      • El círculo gris agrupa el contenido (Click para colapsar - <em>WIP</em>).
    </p>
  </div>

  <!-- Selection Details -->
  <div *ngIf="selectedNode() as node" class="absolute bottom-4 right-4 bg-white p-4 rounded-xl shadow-lg border w-64">
    <h4 class="font-bold text-lg truncate">{{ node.label }}</h4>
    <p class="text-xs text-gray-500 mb-2 font-mono">{{ node.id }}</p>
    <div class="text-sm">
      <span class="px-2 py-1 rounded text-xs font-bold text-white"
            [style.background-color]="node.color">
        {{ node.type }}
      </span>
    </div>
    <button (click)="selectedNode.set(null)" class="mt-3 text-xs text-blue-500 hover:underline">
      Cerrar
    </button>
  </div>
  
  <!-- Loading -->
  <div *ngIf="loading()" class="absolute inset-0 bg-white/80 flex items-center justify-center z-50">
    <div class="animate-pulse text-indigo-600 font-medium">Construyendo Grafo Jerárquico...</div>
  </div>
</div>