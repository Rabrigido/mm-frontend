<div class="max-w-5xl mx-auto p-6">
  <h1 class="text-2xl font-bold mb-6">Repos descargados</h1>

  <!-- Add -->
  <div class="bg-white rounded-2xl border p-4 mb-6">
    <label class="block text-sm font-medium mb-2">Agregar repo por URL (git)</label>
    <div class="flex gap-2">
      <input
        class="flex-1 border rounded-xl px-3 py-2"
        placeholder="https://github.com/usuario/proyecto.git"
        [value]="gitUrl()"
        (input)="gitUrl.set(($any($event.target)).value || '')"
      />
      <button class="px-4 py-2 rounded-xl bg-blue-600 text-white"
              (click)="addRepo()"
              [disabled]="loading()">
        Agregar
      </button>
    </div>
  </div>

  <!-- States -->
  <div *ngIf="loading()" class="text-gray-600 mb-4">Cargando...</div>
  <div *ngIf="error()" class="text-red-600 mb-4">{{ error() }}</div>

  <!-- List -->
  <div class="grid md:grid-cols-2 gap-4" *ngIf="repos() as list">
    <div *ngFor="let r of list" class="bg-white rounded-2xl border p-4">
      <div class="flex items-start justify-between gap-3">
        <div>
          <a [routerLink]="['/repos', r.id]" class="text-lg font-semibold hover:underline">
            {{ r.fullName || r.id }}
          </a>
          <div class="text-xs text-gray-500 break-all">
            {{ r.codePath }}
          </div>
        </div>
        <button class="px-3 py-1.5 rounded-lg bg-red-600 text-white"
                (click)="deleteRepo(r.id)"
                [disabled]="loading()">
          Eliminar
        </button>
      </div>

      <div class="mt-3 text-sm text-gray-700">
        <div *ngIf="r.stats">
          <div>Archivos: <strong>{{ r.stats.files }}</strong></div>
          <div>Líneas: <strong>{{ r.stats.lines }}</strong></div>
          <div>Imports/Exports: <strong>{{ r.stats.imports }}</strong> / <strong>{{ r.stats.exports }}</strong></div>
        </div>
        <div *ngIf="r.scannedAt" class="text-xs text-gray-500 mt-1">
          Último scan: {{ r.scannedAt | date:'short' }}
        </div>
      </div>

      <div class="mt-3">
        <a [routerLink]="['/repos', r.id]" class="text-blue-600 hover:underline text-sm">
          Ver detalles y ejecutar scanner →
        </a>
      </div>
    </div>
  </div>

  <div *ngIf="repos() && repos()!.length === 0" class="text-gray-600">
    No hay repos aún. Agrega uno arriba.
  </div>
</div>
